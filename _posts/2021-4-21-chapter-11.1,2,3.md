# 11. Practical Methodology

좋은 머신러닝 전문가가 되기 위해선 어떤 알고리즘이 존재하고 어떻게 작동 하는지를 정확히 아는 것도 중요하지만, 어떤 알고리즘을 사용할지 정하고 모니터링을 통해 적절한 피드백을 줄 수 있어야한다.

아래의 절차를 참고하면 주어진 문제를 적절하게 해결하는데 도움이 된다.

- 어떤 error metric을 사용할지, target value는 무엇을 사용할지 정한다.
- End-to-end pipeline을 최대한 빨리 구축하고, 적절한 성능 지표를 추정한다.
- 예상보다 성능이 떨어지는 구성 요소가 무엇인지, 그것이 데이터나 소프트웨어의 과적합, 과소 적합 또는 결함 때문인지 진단한다.
- 진단에서 얻은 특정 결과를 바탕으로 새 데이터 수집, 하이퍼 파라미터 조정 또는 알고리즘 변경과 같은 점진적 변경을 반복한다.

## 11.1 Performance Metrics

우리는 error metric을 통해 향후의 행동을 정하기 때문에 error metric을 정하는 것이 첫째로 중요하다. 원하는 성능이 어느정도인지 또한 중요하다. 학계 종사자라면 기대 성능은 기존에 나와있는 벤치마크를 참고하면 되지만, 상업적인 상품을 만드는 사람이라면 비용 효율성, 안정성 등을 고려해야한다. 

- 스팸 메일을 감지하는 기계를 생각해보자. 스팸 메일을 합법적인 메일로 착각하는 것보다, 합법적인 메일을 스팸 메일로 착각하여 쓰레기통에 버리는 것이 cost가 더 클 것이다. 이 경우에는 합법적인 메일를 차단하는 비용이 스팸 메일를 허용하는 비용보다 높은 형태의 총 비용을 사용하는 것이 좋다.
- 레어 이벤트를 1, 일반 이벤트를 0으로 감지하는 이분 분류기를 생각해보자. 정확도를 error metric으로 설정할 경우 이 분류기는 0만 출력해도 매우 높은 성능을 보여준다. 하지만 레어 이벤트를 감지 했는지는 장담할 수 없다. 이 경우 F-score를 사용하는 것이 좋다.

    $$ F = \frac{2pr}{p+r}$$

    $$p = \frac{\text{detected TRUE}}{\text{whole detections of an algorithm}}\ ,\ r = \frac{\text{TRUE detections}}{\text{total number of existing TRUE}}$$

## 11.2 Default Baseline Models

Error metric과 목표설정이 끝나면 어떤 알고리즘을 사용하여 문제를 해결할지 정해야한다. 복잡도가 높지않은 문제라면 굳이 'deep'한 모델을 사용할 필요가 없기 때문에 로지스틱 회귀 모델부터 시작해 보는 것이 좋다.

알맞은 알고리즘을 고르기 위해서 가장 먼저 할 것은 데이터 구조가 어떤 부류에 속하는지 판단해야한다.

길이가 정해진 벡터가 입력으로 들어가는 지도학습 문제라면 fully connected feedforward 네트워크를, 이미지 처럼 토폴로지 구조가 있는 데이터라면 컨볼루션 네트워크를, 시퀀스 데이터라면 gated recurrent 네트워크를 기본 모델로 설정하는 것이 좋다.

이미 연구가 많이 된 문제라면 이미 존재하는 알고리즘을 카피하는 것도 좋은 방법이다.

## 11.3 Determining Whether to Gather More Data

베이스라인 모델이 정해지면 학습 데이터에 대한 성능을 측정하게 될텐데, 만약 성능이 잘 나오지 않는다면 모델 사이즈를 키우거나 여러 파라미터를 조정할 필요가 있다. 그래도 성능이 좋지 않다면 데이터의 퀄리티를 의심해봐야 한다.

학습 데이터에 대한 성능은 잘 나오지만 테스트 데이터에 대한 성능이 좋지 않을 경우에는 데이터 양을 늘리는 것이 효과적인 해결 방법이다.

추가적인 데이터 수집이 어려운 경우에는 모델의 크기를 줄이거나, 가중치 감소 계수와 같은 하이퍼 파라미터를 조정하거나 드롭 아웃과 같은 정규화 전략을 추가하여 정규화를 개선하는 것이 도움이 된다.